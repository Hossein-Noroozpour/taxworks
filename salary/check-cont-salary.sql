SELECT RET0.CA02_TAX_PERIOD, RETCNT.*
FROM 
    RET.TA03_RET_CONTENT RETCNT
    JOIN RET.TA02_RETURNS RET0 ON RET0.CA02_RETURN_ID = RETCNT.CA02_RETURN_ID AND RET0.CA02_RETURN_VERSION = RETCNT.CA02_RETURN_VERSION
    JOIN REG.TR01_TAXPAYER TXP0 ON RET0.CR01_INTERNAL_ID = TXP0.CR01_INTERNAL_ID
WHERE
    TXP0.CR01_TIN_ID = '10100629800'
    AND RET0.CSTD_RETURN_TYPE = 'FRM32'
    AND RET0.CSTD_FILING_CHANNEL = 'RETPTL'
    AND RET0.CA09_TAX_TYPE_CODE = 'WST'
    AND RET0.CSTD_RETURN_SOURCE = 'TXP'
    AND RET0.CA02_TAX_YEAR = '1395'
ORDER BY RET0.CA02_TAX_PERIOD, RET0.CA02_RETURN_ID
;

SELECT RET0.*
FROM 
    RET.TA02_RETURNS RET0
    JOIN REG.TR01_TAXPAYER TXP0 ON RET0.CR01_INTERNAL_ID = TXP0.CR01_INTERNAL_ID
WHERE
    TXP0.CR01_TIN_ID = '10100629800'
    AND RET0.CSTD_RETURN_TYPE = 'FRM32'
    AND RET0.CA02_TAX_YEAR = '1395'
ORDER BY RET0.CA02_TAX_PERIOD
;


SELECT RET0.CR01_INTERNAL_ID, RET0.CA02_TAX_PERIOD, RET0.CA02_RETURN_ID, RET0.CA02_RETURN_VERSION, RET0.CSTD_STATUS, RET0.CA02_TAX_PERIOD
FROM 
    RET.TA02_RETURNS RET0
WHERE
    RET0.CR01_INTERNAL_ID IN (
        '100000000000022213',
        '100000000000023021',
        '100000000000080665',
        '100000000000081406',
        '100000000000081447',
        '100000000000081457',
        '100000000000081460',
        '100000000000081777',
        '100000000000082415',
        '100000000000082560',
        '100000000000083232',
        '100000000000083444',
        '100000000000392346')
    AND RET0.CSTD_RETURN_TYPE = 'FRM32'
    AND RET0.CSTD_FILING_CHANNEL = 'RETPTL'
    AND RET0.CA09_TAX_TYPE_CODE = 'WST'
    AND RET0.CSTD_RETURN_SOURCE = 'TXP'
    AND RET0.CA02_TAX_YEAR = '1395'
ORDER BY RET0.CR01_INTERNAL_ID, RET0.CA02_TAX_PERIOD, RET0.CA02_RETURN_VERSION
;

SELECT DISTINCT TXP0.CR01_TIN_ID
FROM 
    REG.TR01_TAXPAYER TXP0
WHERE
    TXP0.CR01_INTERNAL_ID IN (
        '100000000000081406',
        '100000000000081457',
        '100000000000081460',
        '100000000000083444')
;
